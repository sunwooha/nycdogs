<!DOCTYPE html>
<meta charset="utf-8"/>
<meta property="og:title" content="Exploring Dogs and NYC Boroughs in Three Charts"/>
<title>Exploring Dogs and NYC Boroughs in Three Charts</title>
<html lang="en">
<head>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src = "https://cdnjs.cloudflare.com/ajax/libs/d3-legend/1.1.0/d3-legend.js"></script>

    <title>Exploring Dogs and NYC Boroughs in Three Charts</title>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
    <meta name='description' content='An analysis of different attributes of dogs living in the boroughs of NYC.' />
    <meta name='news_keywords' content='tk' />
    
    <meta property='og:title' content='Exploring Dogs and NYC Boroughs in Three Charts' />
    <meta property='og:site_name' content='Data Visualization and Communication' />
    <meta property='og:url' content='https://sunwooha.github.io/dogs' />
    <meta property='og:description' content='An analysis of different attributes of dogs living in the boroughs of NYC.' />
    <meta property='og:type' content='article' />
    <meta property='og:locale' content='en_US' />
    
    <meta property='og:image' content='https://pudding.cool/year/month/name/' />
    <meta property='og:image:type' content='image/jpeg' />
    <meta property='og:image:width' content='1200' />
    <meta property='og:image:height' content='600' />
    
    <meta name='twitter:card' content='summary_large_image' />
    <meta name='twitter:site' content='https://pudding.cool' />
    <meta name='twitter:creator' content='@hajennifers' />
    <meta name='twitter:title' content='Exploring Dogs and NYC Boroughs in Three Charts' />
    <meta name='twitter:description' content='An analysis of different attributes of dogs living in the boroughs of NYC.' />

    <link rel='stylesheet' href='css/critical.css' />
    <link rel='stylesheet' href='css/bundle.css' />

    <style type="text/css">
        body {
            background-color: #F9F5ED;
        }

        #dog-info {
            color: #000000;
            font-family: 'Canela Web';
            font-size: 18px;
            font-weight: bold;
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 0.5%;
        }
        .legendOrdinal {
            font-family: 'Canela Web';
            font-size: 15px;
        }

        div.gifs{
            display: block;
            margin-left: auto;
            margin-right: auto;
            width: 30%;
        }

        div.bubblediv{
            position: relative;
            margin-left: auto;
            margin-right: auto;
        }

        div.bubbleintro{
            margin-left: 20%;
            margin-right: 20%;
        }

        .changecolor{
            color: #9D5C63;
        }

        @font-face {
            font-family: 'Canela Web';
            src: url('https://pudding.cool/assets/fonts/canela/Canela-Light-Web.woff2') format('woff2'),
            url('https://pudding.cool/assets/fonts/canela/Canela-Light-Web.woff') format('woff');
            font-weight: 300;
            font-style: normal;
            font-stretch: normal;
        }

        @font-face {
            font-family: 'Canela Web';
            src: url('https://pudding.cool/assets/fonts/canela/Canela-Bold-Web.woff2') format('woff2'),
            url('https://pudding.cool/assets/fonts/canela/Canela-Bold-Web.woff') format('woff');
            font-weight: 700;
            font-style: normal;
            font-stretch: normal;
        }
        /* Publico Text */

        @font-face {
            font-family: 'Publico Text Web';
            src: url('https://pudding.cool/assets/fonts/publico/PublicoText-Roman-Web.woff2') format('woff2'),
            url('https://pudding.cool/assets/fonts/publico/PublicoText-Roman-Web.woff') format('woff');
            font-weight: 400;
            font-style: normal;
            font-stretch: normal;
        }

        @font-face {
            font-family: 'Publico Text Web';
            src: url('https://pudding.cool/assets/fonts/publico/PublicoText-Bold-Web.woff2') format('woff2'),
            url('https://pudding.cool/assets/fonts/publico/PublicoText-Bold-Web.woff') format('woff');
            font-weight: 700;
            font-style: normal;
            font-stretch: normal;
        }

        @font-face {
            font-family: 'Publico Text Web';
            src: url('https://pudding.cool/assets/fonts/publico/PublicoText-Italic-Web.woff2') format('woff2'),
            url('https://pudding.cool/assets/fonts/publico/PublicoText-Italic-Web.woff') format('woff');
            font-weight: 400;
            font-style: italic;
            font-stretch: normal;
        }
        
        @font-face {
            font-family: 'Atlas Grotesk Web';
            src: url('https://pudding.cool/assets/fonts/atlas/AtlasGrotesk-Regular-Web.woff2') format('woff2'),
            url('https://pudding.cool/assets/fonts/atlas/AtlasGrotesk-Regular-Web.woff') format('woff');
            font-weight: 400;
            font-style: normal;
            font-stretch: normal;
        }

        @font-face {
            font-family: 'Atlas Grotesk Web';
            src: url('https://pudding.cool/assets/fonts/atlas/AtlasGrotesk-Medium-Web.woff2') format('woff2'),
            url('https://pudding.cool/assets/fonts/atlas/AtlasGrotesk-Medium-Web.woff') format('woff');
            font-weight: 500;
            font-style: normal;
            font-stretch: normal;
        }

        @font-face {
            font-family: 'Atlas Grotesk Web';
            src: url('https://pudding.cool/assets/fonts/atlas/AtlasGrotesk-Bold-Web.woff2') format('woff2'),
            url('https://pudding.cool/assets/fonts/atlas/AtlasGrotesk-Bold-Web.woff') format('woff');
            font-weight: 600;
            font-style: normal;
            font-stretch: normal;
        }
    </style>
</head>

<script src='css/critical.js'></script>

<body class='tk-publico'>
    <a href='#content' class='skip-to-main'>Skip to main content</a>

    <main id='content' align='center'>

        <!-- Header -->
        <div class='intro'>
            <div class='gifs'>
                <img src='images/dogs.gif' class='displayed'/>
            </div>
            <h1 class='intro__hed tk-canela'>Exploring Dogs and NYC Boroughs in Three Charts</h1>
            <p class='intro__dek tk-atlas'>An analysis of different attributes of dogs living in the boroughs of NYC.</p>
            <p class='intro__byline tk-atlas'>By <a href='https://github.com/sunwooha' target='_blank'><strong>Jennifer Ha</strong></a></p>
        </div>

        <!-- Bubble Chart -->
        <div class="bubble-container">

            <!-- Title and Prose -->
            <div class= 'bubbleprose'>
                <div class= 'bubbleintro'>
                    <h2 class='bubbleprose_hed tk-canela'><strong>Popularity of
                            <span class="changecolor"> Breeds </span>
                            in Each Borough</strong></h2> 
                    <p>Count of unique dog breeds in Brooklyn, Manhattan, Queens, Staten Island, and the Bronx.
                        The larger the circle, the more instances of that breed in its respective borough.
                        Hover over the circles to see the breed and their count!
                    </p>
                </div>
                <div id="dog-info"></div> 
                <div class='bubblediv' align = 'center'>
                    <script>
                        var width = 1000,
                            height = 800,
                            padding = 1.5, // separation between same-color nodes
                            clusterPadding = 6, // separation between different-color nodes
                            maxRadius = 9;
        
                        var color = d3.scale.ordinal()
                            .range(["#584B53", "#9D5C63", "#D6E3F8", "#94958B", "#E4BB97"]);
        
                        d3.text("data/breeds_borough_count.csv", function(error, text) {
                            if (error) throw error;
                            var colNames = "group,text,size\n" + text;
                            var data = d3.csv.parse(colNames);
        
                        data.forEach(function(d) {
                            d.size = +d.size;
                        });
        
                        //unique cluster/group id's
                        var cs = [];
                        data.forEach(function(d){
                            if(!cs.includes(d.group)) {
                                cs.push(d.group);
                            }
                        });
        
                        var n = data.length, // total number of nodes
                            m = cs.length; // number of distinct clusters
        
                        //create clusters and nodes
                        var clusters = new Array(m);
                        var nodes = [];
                        for (var i = 0; i<n; i++){
                            nodes.push(create_nodes(data,i));
                        }
        
                        var force = d3.layout.force()
                            .nodes(nodes)
                            .size([width, height])
                            .gravity(.02)
                            .charge(0)
                            .on("tick", tick)
                            .start();
        
                        var svg = d3.select(".bubblediv").append("svg")
                            .attr("width", width)
                            .attr("height", height)
        
                        var node = svg.selectAll("circle")
                            .data(nodes)
                            .enter().append("g")
                            .call(force.drag);
        
                        node.append("circle")
                            .style("fill", function (d) {
                                return color(d.cluster);
                            })
                            .attr("r", function(d){return d.radius})
                            .on("mouseover", function(d){
                                d3.select(this).style("opacity", 0.75);
                                updateDogInfo(d)})
                            .on("mouseout", function(d){
                                d3.select(this).style("opacity", 1);
                                updateDogInfo(d)});
        
                        svg.append("g")
                            .attr("class", "legendOrdinal")
                            .attr("transform", "translate(5,10)");
        
                        var ordinalLegend = d3.scale.ordinal()
                            .domain(["Queens", "Brooklyn", "The Bronx", "Manhattan","Staten Island"])
                            .range([ "#E4BB97", "#D6E3F8", "#9D5C63", "#94958B", "#584B53"]);
        
                        var legendOrdinal = d3.legend.color()
                            .labelFormat(d3.format(".0f"))
                            .scale(ordinalLegend)
                            .shapePadding(5)
                            .shapeWidth(20)
                            .shapeHeight(20)
                            .labelOffset(12);
        
                        svg.select(".legendOrdinal")
                            .call(legendOrdinal);
        
                        function updateDogInfo(cir) {
                            var info = "";
                            if (cir) {
                                info = [cir.text, cir.size].join(": ");
                            }
                            else{
                                info = "";
                            }
                            d3.select("#dog-info").html(info);
                        };
        
                        function create_nodes(data,node_counter) {
                        var i = cs.indexOf(data[node_counter].group),
                            r = Math.sqrt((i + 1) / m * -Math.log(Math.random())) * maxRadius,
                            d = {
                                borough: data[node_counter].group,
                                text: data[node_counter].text,
                                size: data[node_counter].size, 
                                cluster: i,
                                radius: Math.log2(data[node_counter].size)*(maxRadius/(5)),
                                x: Math.cos(i / m * 2 * Math.PI) * 100 + width / 2 + Math.random(),
                                y: Math.sin(i / m * 2 * Math.PI) * 100 + height / 2 + Math.random()
                            };
                        if (!clusters[i] || (r > clusters[i].radius)) clusters[i] = d;
                        return d;
                        };
        
                        function tick(e) {
                            node.each(cluster(10 * e.alpha * e.alpha))
                                .each(collide(.5))
                            .attr("transform", function (d) {
                                var k = "translate(" + d.x + "," + d.y + ")";
                                return k;
                            })
        
                        }
        
                        // Move d to be adjacent to the cluster node.
                        function cluster(alpha) {
                            return function (d) {
                                var cluster = clusters[d.cluster];
                                if (cluster === d) return;
                                var x = d.x - cluster.x,
                                    y = d.y - cluster.y,
                                    l = Math.sqrt(x * x + y * y),
                                    r = d.radius + cluster.radius;
                                if (l != r) {
                                    l = (l - r) / l * alpha;
                                    d.x -= x *= l;
                                    d.y -= y *= l;
                                    cluster.x += x;
                                    cluster.y += y;
                                }
                            };
                        }
        
                        // Resolves collisions between d and all other circles.
                        function collide(alpha) {
                            var quadtree = d3.geom.quadtree(nodes);
                            return function (d) {
                                var r = d.radius + maxRadius + Math.max(padding, clusterPadding),
                                    nx1 = d.x - r,
                                    nx2 = d.x + r,
                                    ny1 = d.y - r,
                                    ny2 = d.y + r;
                                quadtree.visit(function (quad, x1, y1, x2, y2) {
                                    if (quad.point && (quad.point !== d)) {
                                        var x = d.x - quad.point.x,
                                            y = d.y - quad.point.y,
                                            l = Math.sqrt(x * x + y * y),
                                            r = d.radius + quad.point.radius + (d.cluster === quad.point.cluster ? padding : clusterPadding);
                                        if (l < r) {
                                            l = (l - r) / l * alpha;
                                            d.x -= x *= l;
                                            d.y -= y *= l;
                                            quad.point.x += x;
                                            quad.point.y += y;
                                        }
                                    }
                                    return x1 > nx2 || x2 < nx1 || y1 > ny2 || y2 < ny1;
                                });
                            };
                        }
                        });         
                    </script>
                </div>
                <p>Text explaining a little bit about the bubble chart</p>
            </div>               
        </div>
        <!-- Age Bar Chart -->
        <div class='agedist-container'>
            <!-- Title and Prose -->
            <div class= 'ageprose'>
                <h2 class='ageprose_hed tk-canela'>
                    <strong><span class="changecolor">Age</span> 
                        Distribution of Dogs in Each Borough</strong></h2>  
                <p>Distribution of the ages of dogs (as of 2015) in NYC from 1 year old to 18 years old!</p>  
            </div>
        </div>
    </main>        
</body>
</html>